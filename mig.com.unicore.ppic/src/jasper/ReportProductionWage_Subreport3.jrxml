<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ReportProductionWage_Subreport3" language="groovy" pageWidth="555" pageHeight="802" columnWidth="555" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="08ea5c0d-93fb-41fe-a3db-b89d2057a077">
	<property name="ireport.zoom" value="1.3310000000000006"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="DateFrom" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="DateTo" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="UNS_Employee_ID" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="AD_Org_ID" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT org.Name AS Org, pr.DocumentNo AS DocNo, pr.MovementDate AS MoveDate, p.Name AS Product, UOMConversionToSTR(p.M_Product_ID, pd.MovementQty) AS ProductionQty, jr.Name AS Position, emp.Name AS Employee, prpt.Name AS Grade, prpt.PayableAmt AS Amount FROM UNS_Production pr

INNER JOIN AD_Org org ON org.AD_Org_ID = pr.AD_Org_ID
INNER JOIN UNS_Production_Detail pd ON pd.UNS_Production_ID = pr.UNS_Production_ID
INNER JOIN M_Product p ON p.M_Product_ID = pd.M_Product_ID
INNER JOIN UNS_ProductionPayConfig ppc ON ppc.UNS_ProductionPayConfig_ID = pr.UNS_ProductionPayConfig_ID
INNER JOIN UNS_Production_Worker pw ON pw.UNS_Production_ID = pr.UNS_Production_ID
INNER JOIN UNS_Job_Role jr ON jr.UNS_Job_Role_ID = pw.UNS_Job_Role_ID
INNER JOIN UNS_PayRollLine prl ON prl.UNS_ProductionPayConfig_ID = ppc.UNS_ProductionPayConfig_ID AND jr.UNS_Job_Role_ID = prl.UNS_Job_Role_ID
INNER JOIN UNS_Employee emp ON emp.UNS_Employee_ID = pw.ReplacementLabor_ID
INNER JOIN UNS_PayRollPremiTarget prpt ON prpt.UNS_PayRollLine_ID = prl.UNS_PayRollLine_ID AND pd.MovementQty BETWEEN prpt.TargetMin AND prpt.TargetMax

WHERE pr.MovementDate BETWEEN $P{DateFrom} AND $P{DateTo} AND pr.DocStatus IN ('CO', 'CL') AND pd.IsPrimary = 'Y' AND pr.AD_Org_ID = $P{AD_Org_ID} AND (CASE WHEN $P{UNS_Employee_ID} IS NOT NULL THEN emp.UNS_Employee_ID = $P{UNS_Employee_ID} ELSE 1=1 END)

ORDER BY Position, Employee, Grade]]>
	</queryString>
	<field name="org" class="java.lang.String"/>
	<field name="docno" class="java.lang.String"/>
	<field name="movedate" class="java.sql.Timestamp"/>
	<field name="product" class="java.lang.String"/>
	<field name="productionqty" class="java.lang.String"/>
	<field name="position" class="java.lang.String"/>
	<field name="employee" class="java.lang.String"/>
	<field name="grade" class="java.lang.String"/>
	<field name="amount" class="java.math.BigDecimal"/>
	<variable name="production_count" class="java.lang.Integer" resetType="Group" resetGroup="Grade">
		<variableExpression><![CDATA[$V{production_count} == null ? 1 : $V{production_count} + 1]]></variableExpression>
	</variable>
	<variable name="grade_amt" class="java.math.BigDecimal" resetType="Group" resetGroup="Grade">
		<variableExpression><![CDATA[$V{production_count} * $F{amount}]]></variableExpression>
	</variable>
	<variable name="employee_amt" class="java.math.BigDecimal" resetType="Group" resetGroup="Employee" incrementType="Group" incrementGroup="Grade" calculation="Sum">
		<variableExpression><![CDATA[$V{grade_amt}]]></variableExpression>
	</variable>
	<variable name="position_amt" class="java.math.BigDecimal" resetType="Group" resetGroup="Position" incrementType="Group" incrementGroup="Employee" calculation="Sum">
		<variableExpression><![CDATA[$V{employee_amt}]]></variableExpression>
	</variable>
	<variable name="total_amt" class="java.math.BigDecimal" incrementType="Group" incrementGroup="Position" calculation="Sum">
		<variableExpression><![CDATA[$V{position_amt}]]></variableExpression>
	</variable>
	<group name="Position">
		<groupExpression><![CDATA[$F{position}]]></groupExpression>
		<groupHeader>
			<band height="17">
				<textField>
					<reportElement uuid="a1bd1b70-0f59-408b-bbfb-a1e64c9d4534" x="0" y="0" width="555" height="17"/>
					<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2"/>
					<textElement verticalAlignment="Middle">
						<font isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{position}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="17">
				<textField evaluationTime="Group" evaluationGroup="Position" pattern="#,##0.00">
					<reportElement uuid="309c8f05-8447-45ed-a17f-0c1a1c083fad" x="470" y="0" width="85" height="17"/>
					<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font size="10"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{position_amt}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement uuid="a1bd1b70-0f59-408b-bbfb-a1e64c9d4534" x="0" y="0" width="470" height="17"/>
					<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA["TOTAL " + $F{position}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<group name="Employee" keepTogether="true">
		<groupExpression><![CDATA[$F{employee}]]></groupExpression>
		<groupHeader>
			<band height="17">
				<textField>
					<reportElement uuid="309c8f05-8447-45ed-a17f-0c1a1c083fad" x="51" y="0" width="504" height="17"/>
					<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2"/>
					<textElement verticalAlignment="Middle">
						<font isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{employee}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="17">
				<textField evaluationTime="Group" evaluationGroup="Employee" pattern="#,##0.00">
					<reportElement uuid="309c8f05-8447-45ed-a17f-0c1a1c083fad" x="470" y="0" width="85" height="17"/>
					<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font size="10"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{employee_amt}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement uuid="a1bd1b70-0f59-408b-bbfb-a1e64c9d4534" x="0" y="0" width="470" height="17"/>
					<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA["TOTAL " + $F{employee}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<group name="Grade">
		<groupExpression><![CDATA[$F{grade}]]></groupExpression>
		<groupHeader>
			<band height="34">
				<textField>
					<reportElement uuid="309c8f05-8447-45ed-a17f-0c1a1c083fad" x="81" y="0" width="255" height="17"/>
					<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2"/>
					<textElement verticalAlignment="Middle">
						<font size="10"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{grade}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement uuid="d07e8570-3c49-4c6a-bf7e-c0479734731a" x="0" y="17" width="100" height="17"/>
					<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
						<pen lineWidth="0.5"/>
						<topPen lineWidth="0.5"/>
						<leftPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center"/>
					<text><![CDATA[Document]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="e8634d96-ff42-413a-b3db-cb42f5fb61d1" x="100" y="17" width="81" height="17"/>
					<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
						<pen lineWidth="0.5"/>
						<topPen lineWidth="0.5"/>
						<leftPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center"/>
					<text><![CDATA[Date]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="63781567-22b3-47d8-928b-4241da8781f7" x="181" y="17" width="289" height="17"/>
					<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
						<pen lineWidth="0.5"/>
						<topPen lineWidth="0.5"/>
						<leftPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center"/>
					<text><![CDATA[Product]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="d0dd93a4-3a92-4336-be6e-dc862e4d1839" x="470" y="17" width="85" height="17"/>
					<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
						<pen lineWidth="0.5"/>
						<topPen lineWidth="0.5"/>
						<leftPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center"/>
					<text><![CDATA[Qty]]></text>
				</staticText>
				<textField evaluationTime="Group" evaluationGroup="Grade" pattern="#,##0.00">
					<reportElement uuid="309c8f05-8447-45ed-a17f-0c1a1c083fad" x="390" y="0" width="80" height="17"/>
					<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font size="10"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{amount}]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Group" evaluationGroup="Grade">
					<reportElement uuid="309c8f05-8447-45ed-a17f-0c1a1c083fad" x="336" y="0" width="54" height="17"/>
					<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font size="10"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{production_count}]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Group" evaluationGroup="Grade" pattern="#,##0.00">
					<reportElement uuid="309c8f05-8447-45ed-a17f-0c1a1c083fad" x="470" y="0" width="85" height="17"/>
					<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font size="10"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{grade_amt}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="3"/>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="59" splitType="Stretch">
			<staticText>
				<reportElement uuid="01b908d9-2e29-4155-8c0b-39a2f3e40ee3" x="455" y="5" width="100" height="20"/>
				<textElement>
					<font size="8" isItalic="true"/>
				</textElement>
				<text><![CDATA[UntaERP System]]></text>
			</staticText>
			<textField>
				<reportElement uuid="83d75136-e9ab-4822-8080-74e8a96c5791" x="0" y="36" width="555" height="20"/>
				<textElement>
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Period : " + new SimpleDateFormat("dd/MM/yyy").format($P{DateFrom}) + " - "
+ new SimpleDateFormat("dd/MM/yyyy").format($P{DateTo})]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="f56c1c76-9eb6-4210-9f92-a9f012c9923f" x="0" y="1" width="555" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="14" isBold="true" isUnderline="true"/>
				</textElement>
				<text><![CDATA[Production Wage]]></text>
			</staticText>
			<textField>
				<reportElement uuid="ce9b96b2-be06-404d-9533-7ec81b66580b" x="0" y="16" width="555" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{org}]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<detail>
		<band height="17" splitType="Stretch">
			<textField>
				<reportElement uuid="309c8f05-8447-45ed-a17f-0c1a1c083fad" x="181" y="0" width="289" height="17"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{product}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="309c8f05-8447-45ed-a17f-0c1a1c083fad" x="470" y="0" width="85" height="17"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{productionqty}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement uuid="309c8f05-8447-45ed-a17f-0c1a1c083fad" x="100" y="0" width="81" height="17"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{movedate}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="309c8f05-8447-45ed-a17f-0c1a1c083fad" x="0" y="0" width="100" height="17"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{docno}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<summary>
		<band height="17" splitType="Stretch">
			<staticText>
				<reportElement uuid="020b344e-a9f5-4d36-a17e-3cf001b8ec65" x="0" y="0" width="470" height="17"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.0"/>
					<topPen lineWidth="0.0"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.0"/>
					<rightPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle" markup="none">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[TOTAL]]></text>
			</staticText>
			<textField evaluationTime="Group" evaluationGroup="Position" pattern="#,##0.00">
				<reportElement uuid="309c8f05-8447-45ed-a17f-0c1a1c083fad" x="470" y="0" width="85" height="17"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="10" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{total_amt}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>

<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ReportProductionWage_Subreport1" language="groovy" pageWidth="555" pageHeight="802" columnWidth="555" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="11c80f1a-60dd-4122-8297-a855366bfa3c">
	<property name="ireport.zoom" value="1.3310000000000008"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="DateFrom" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="DateTo" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="UNS_Employee_ID" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="AD_Org_ID" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT Master.Org, Master.Position, Master.Employee, SUM(Master.Amount) AS Amount, COUNT(Master.WorkDay) AS WorkDay FROM(SELECT org.Name AS Org, jr.Name AS Position, emp.Name AS Employee, SUM(prpt.PayableAmt) AS Amount, COUNT(*) AS WorkDay FROM UNS_Production pr

INNER JOIN AD_Org org ON org.AD_Org_ID = pr.AD_Org_ID
INNER JOIN UNS_Production_Detail pd ON pd.UNS_Production_ID = pr.UNS_Production_ID
INNER JOIN UNS_ProductionPayConfig ppc ON ppc.UNS_ProductionPayConfig_ID = pr.UNS_ProductionPayConfig_ID
INNER JOIN UNS_Production_Worker pw ON pw.UNS_Production_ID = pr.UNS_Production_ID
INNER JOIN UNS_Job_Role jr ON jr.UNS_Job_Role_ID = pw.UNS_Job_Role_ID
INNER JOIN UNS_PayRollLine prl ON prl.UNS_ProductionPayConfig_ID = ppc.UNS_ProductionPayConfig_ID AND jr.UNS_Job_Role_ID = prl.UNS_Job_Role_ID
INNER JOIN UNS_Employee emp ON emp.UNS_Employee_ID = pw.ReplacementLabor_ID
INNER JOIN UNS_PayRollPremiTarget prpt ON prpt.UNS_PayRollLine_ID = prl.UNS_PayRollLine_ID AND pd.MovementQty BETWEEN prpt.TargetMin AND prpt.TargetMax

WHERE pr.MovementDate BETWEEN $P{DateFrom} AND $P{DateTo} AND pr.DocStatus IN ('CO', 'CL') AND pd.IsPrimary = 'Y' AND pr.AD_Org_ID = $P{AD_Org_ID} AND (CASE WHEN $P{UNS_Employee_ID} IS NOT NULL THEN emp.UNS_Employee_ID = $P{UNS_Employee_ID} ELSE 1=1 END)

GROUP BY jr.UNS_Job_Role_ID, emp.UNS_Employee_ID, org.AD_Org_ID, pr.ProductionDate

ORDER BY Position, Employee) AS Master

GROUP BY Master.Org, Master.Position, Master.Employee

ORDER BY Master.Position, Master.Employee]]>
	</queryString>
	<field name="org" class="java.lang.String"/>
	<field name="position" class="java.lang.String"/>
	<field name="employee" class="java.lang.String"/>
	<field name="amount" class="java.math.BigDecimal"/>
	<field name="workday" class="java.lang.Long"/>
	<variable name="sum_amt" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{amount}]]></variableExpression>
	</variable>
	<variable name="num" class="java.lang.Integer">
		<variableExpression><![CDATA[$V{num} == null ? 1 : $V{num} + 1]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="59" splitType="Stretch">
			<staticText>
				<reportElement uuid="f56c1c76-9eb6-4210-9f92-a9f012c9923f" x="0" y="0" width="555" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="14" isBold="true" isUnderline="true"/>
				</textElement>
				<text><![CDATA[Production Wage]]></text>
			</staticText>
			<textField>
				<reportElement uuid="83d75136-e9ab-4822-8080-74e8a96c5791" x="0" y="35" width="555" height="20"/>
				<textElement>
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Period : " + new SimpleDateFormat("dd/MM/yyy").format($P{DateFrom}) + " - "
+ new SimpleDateFormat("dd/MM/yyyy").format($P{DateTo})]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="ce9b96b2-be06-404d-9533-7ec81b66580b" x="0" y="15" width="555" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{org}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="01b908d9-2e29-4155-8c0b-39a2f3e40ee3" x="455" y="4" width="100" height="20"/>
				<textElement>
					<font size="8" isItalic="true"/>
				</textElement>
				<text><![CDATA[UntaERP System]]></text>
			</staticText>
		</band>
	</title>
	<columnHeader>
		<band height="20" splitType="Stretch">
			<staticText>
				<reportElement uuid="abc78971-7d6d-4a8b-8ff0-eccf0d5e118f" x="22" y="0" width="144" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[Position]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="6f0f6a04-93a5-40c7-886b-94651bf210ff" x="166" y="0" width="187" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[Worker]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="5b1ee2e4-b0ee-4ea5-9ed6-8a240382d7c4" x="385" y="0" width="98" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[Amount]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="abc78971-7d6d-4a8b-8ff0-eccf0d5e118f" x="0" y="0" width="22" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[No.]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="5b1ee2e4-b0ee-4ea5-9ed6-8a240382d7c4" x="353" y="0" width="32" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[Day]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="5b1ee2e4-b0ee-4ea5-9ed6-8a240382d7c4" x="483" y="0" width="70" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[TTD]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="20" splitType="Stretch">
			<textField>
				<reportElement uuid="859eaef5-0eb5-4bd1-8718-8680403b6164" x="22" y="0" width="144" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{position}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="3aee8f26-470c-4803-8346-7207e484a24b" x="166" y="0" width="187" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{employee}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="47ec4588-7915-47b0-b6c9-a2b4aa40e5e6" x="385" y="0" width="98" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{amount}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="859eaef5-0eb5-4bd1-8718-8680403b6164" x="0" y="0" width="22" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{num}]]></textFieldExpression>
			</textField>
			<textField pattern="###0">
				<reportElement uuid="47ec4588-7915-47b0-b6c9-a2b4aa40e5e6" x="353" y="0" width="32" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{workday}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="dd5a8a38-e450-4b04-876b-79bf12ac64d6" x="483" y="0" width="70" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
					<font size="10"/>
				</textElement>
				<text><![CDATA[......................]]></text>
			</staticText>
		</band>
	</detail>
	<summary>
		<band height="20" splitType="Stretch">
			<textField pattern="#,##0.00">
				<reportElement uuid="47ec4588-7915-47b0-b6c9-a2b4aa40e5e6" x="385" y="0" width="98" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="10" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{sum_amt}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="020b344e-a9f5-4d36-a17e-3cf001b8ec65" x="0" y="0" width="385" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle" markup="none">
					<font size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[TOTAL]]></text>
			</staticText>
		</band>
	</summary>
</jasperReport>

<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ReportInsentiveProduksi" language="groovy" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="dfa97198-2ffd-41d5-b209-ae7bd65c4921">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="StartDate" class="java.util.Date"/>
	<parameter name="EndDate" class="java.util.Date"/>
	<parameter name="AD_Org_ID" class="java.lang.Integer"/>
	<queryString>
		<![CDATA[select data2.orgname,data2.worker,data2.jabatan,sum(data2.trupah*stdl) as ustdl,sum(data2.trupah*stdm) as ustdm,
sum(data2.trupah*stds) as ustds,sum(data2.trupah*stdss) as ustdss
from(
select data.orgname,data.tglproduksi,data.worker,data.jabatan,data.trgmin,data.trgmax,data.trupah,data.qtyproduksi,data.stdl,data.stdm,data.stds,data.stdss
from (
SELECT org.name as orgname,pr.productiondate as tglproduksi,em.name as worker,job.name as jabatan,pt.targetmin as trgmin,pt.targetmax as trgmax,pt.payableamt as trupah,pr.productionqty as qtyproduksi,
case when pr.productionqty>=3000 then 1 else 0 end as stdl,
case when pr.productionqty>=2800 and pr.productionqty<=2999 then 1 else 0 end as stdm,
case when pr.productionqty>=2200 and pr.productionqty<=2799 then 1 else 0 end as stds,
case when pr.productionqty<=2199 then 1 else 0 end as stdss
FROM UNS_Production pr
left join UNS_Production_Worker wk on wk.uns_production_id=pr.uns_production_id
INNER join uns_employee em on em.uns_employee_id=wk.labor_id
left join UNS_ProductionPayConfig pc on pc.uns_productionpayconfig_id=pr.uns_productionpayconfig_id
left join UNS_PayRollLine py on py.uns_job_role_id=wk.uns_job_role_id and py.uns_productionpayconfig_id=py.uns_productionpayconfig_id
left join uns_payrollpremitarget pt on pt.uns_payrollline_id=pt.uns_payrollline_id
left join uns_job_role job on job.uns_job_role_id=wk.uns_job_role_id
left join ad_org org on org.ad_org_id=pr.ad_org_id
WHERE pr.isworkerbase='Y' and pr.productiondate between $P{StartDate} and $P{EndDate} and org.AD_Org_ID=$P{AD_Org_ID} and pr.DocStatus in('CO','CL') ) as data
where data.qtyproduksi>=data.trgmin and data.qtyproduksi<=data.trgmax) as data2
group by data2.orgname,data2.worker,data2.jabatan
order by data2.jabatan,data2.worker]]>
	</queryString>
	<field name="orgname" class="java.lang.String"/>
	<field name="worker" class="java.lang.String"/>
	<field name="jabatan" class="java.lang.String"/>
	<field name="ustdl" class="java.math.BigDecimal"/>
	<field name="ustdm" class="java.math.BigDecimal"/>
	<field name="ustds" class="java.math.BigDecimal"/>
	<field name="ustdss" class="java.math.BigDecimal"/>
	<variable name="tterima" class="java.lang.Double">
		<variableExpression><![CDATA[$F{ustdl}+$F{ustdm}+$F{ustds}+$F{ustdss}]]></variableExpression>
	</variable>
	<variable name="nourut" class="java.lang.Integer" resetType="Group" resetGroup="Jabatan" calculation="Count">
		<variableExpression><![CDATA[new Integer('1')]]></variableExpression>
	</variable>
	<group name="Jabatan">
		<groupExpression><![CDATA[$F{jabatan}]]></groupExpression>
		<groupHeader>
			<band height="24">
				<textField>
					<reportElement x="210" y="4" width="244" height="20" uuid="903107fd-636a-4cd4-9b2d-a11674092fb3"/>
					<textFieldExpression><![CDATA[$F{jabatan}]]></textFieldExpression>
				</textField>
				<line>
					<reportElement x="135" y="19" width="211" height="1" uuid="7a08689e-4884-412c-b30e-c68b026cfc0a"/>
				</line>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="12">
				<line>
					<reportElement x="2" y="4" width="413" height="1" uuid="1fede4a0-eafb-4838-b4e9-e8680e8e415f"/>
				</line>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<columnHeader>
		<band height="101" splitType="Stretch">
			<rectangle>
				<reportElement x="2" y="72" width="800" height="29" uuid="3dac744a-755c-440c-8044-91ab469f2cb3"/>
			</rectangle>
			<staticText>
				<reportElement x="0" y="0" width="802" height="24" uuid="26abb794-5026-4658-a297-45ac79c74cad"/>
				<textElement textAlignment="Center">
					<font size="16" isBold="true" isUnderline="true"/>
				</textElement>
				<text><![CDATA[Insentive Produksi]]></text>
			</staticText>
			<textField>
				<reportElement x="0" y="24" width="802" height="20" uuid="db901f3f-631b-4a08-85fb-2e425a7951d1"/>
				<textElement textAlignment="Center">
					<font size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{orgname}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="702" y="0" width="100" height="20" uuid="fbb0906f-5eaa-46c0-ab81-34ea5bbd656c"/>
				<textElement textAlignment="Right"/>
				<text><![CDATA[UntaCoreERP]]></text>
			</staticText>
			<textField>
				<reportElement x="2" y="44" width="304" height="20" uuid="3e02268b-f8cc-4588-bc5d-981cadd83d29"/>
				<textFieldExpression><![CDATA["Periode Tanggal : "+new SimpleDateFormat("dd/MM/yyyy").format($P{StartDate})+' s/d '+
new SimpleDateFormat("dd/MM/yyyy").format($P{EndDate})]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="8" y="81" width="30" height="20" uuid="01b420e5-4f9b-455b-a487-173d56033247"/>
				<text><![CDATA[No.]]></text>
			</staticText>
			<staticText>
				<reportElement x="165" y="81" width="119" height="20" uuid="66ed7634-6985-495d-95fd-ffb0e959c48a"/>
				<text><![CDATA[Jabatan ]]></text>
			</staticText>
			<staticText>
				<reportElement x="46" y="81" width="164" height="20" uuid="fd0f1649-1b59-4a21-8fe8-d0b12a3dd14f"/>
				<text><![CDATA[Nama Karyawan]]></text>
			</staticText>
			<staticText>
				<reportElement x="284" y="72" width="62" height="29" uuid="44d6cce4-6de5-46a9-a1dc-cc390cc8150d"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None"/>
				<text><![CDATA[Grade 1 / STD L]]></text>
			</staticText>
			<staticText>
				<reportElement x="353" y="72" width="62" height="29" uuid="dada74bd-a319-4a84-b522-b26d9a84b27f"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None"/>
				<text><![CDATA[Grade 2 / STD M]]></text>
			</staticText>
			<staticText>
				<reportElement x="418" y="72" width="62" height="29" uuid="0ea1d615-9b7d-49ed-8da3-822c448fc341"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None"/>
				<text><![CDATA[Grade 3 / STD S]]></text>
			</staticText>
			<staticText>
				<reportElement x="486" y="72" width="62" height="29" uuid="81182b42-4177-4ffb-b8ae-2979406dae7a"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None"/>
				<text><![CDATA[Grade 4 / STD SS]]></text>
			</staticText>
			<staticText>
				<reportElement x="548" y="72" width="90" height="29" uuid="28e69968-e9d3-48db-8f6b-1f6e629c22fc"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None"/>
				<text><![CDATA[Jumlah Diterima]]></text>
			</staticText>
			<staticText>
				<reportElement x="638" y="72" width="151" height="29" uuid="390147af-9cf2-4046-b9db-fa624eb55de8"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None"/>
				<text><![CDATA[Tanda Tangan]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="25" splitType="Stretch">
			<textField pattern="#,##0">
				<reportElement x="268" y="0" width="72" height="20" uuid="39a9e525-0210-42fc-9530-8684bd19457d"/>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA[$F{ustdl}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="346" y="0" width="69" height="20" uuid="ebba5c10-4600-410d-9c69-15d4e11a76e2"/>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA[$F{ustdm}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="415" y="0" width="65" height="20" uuid="e0808338-0a16-412f-8441-254f586448b8"/>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA[$F{ustds}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="480" y="0" width="68" height="20" uuid="b3e5f0ed-1d5f-44fe-8eb6-2b6a38352b47"/>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA[$F{ustdss}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="46" y="0" width="164" height="20" uuid="d6122daf-9b33-4e4e-acb9-10938d450ca8"/>
				<textFieldExpression><![CDATA[$F{worker}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="548" y="0" width="77" height="20" uuid="9b9a5787-07f2-491c-8479-530073454ede"/>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA[$V{tterima}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement x="638" y="19" width="151" height="1" uuid="2dcd52cb-065c-47e3-bc26-cbf57dd3e85e"/>
				<graphicElement>
					<pen lineStyle="Dotted"/>
				</graphicElement>
			</line>
			<textField>
				<reportElement x="8" y="0" width="30" height="20" uuid="9cab0bd1-9660-40e0-9bfc-3700eaf9a7fb"/>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA[$V{nourut}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="20" splitType="Stretch">
			<textField>
				<reportElement x="646" y="0" width="80" height="20" uuid="c1d6d6cc-de34-4152-9b56-5cf2c5aefcb4"/>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA["Page "+$V{PAGE_NUMBER}+" of"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="726" y="0" width="40" height="20" uuid="f52fdc8c-a139-455f-9c73-0a820e97ba63"/>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement x="592" y="18" width="197" height="1" uuid="e568bf75-f83e-45d9-a362-7ba32dc68c25"/>
			</line>
		</band>
	</pageFooter>
</jasperReport>

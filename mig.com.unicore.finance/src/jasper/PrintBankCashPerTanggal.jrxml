<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="PrintBankCashPerTanggal" language="groovy" pageWidth="612" pageHeight="792" columnWidth="572" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="34f5ba20-279a-483a-abcf-77457045aa83">
	<property name="ireport.zoom" value="1.6500000000000001"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="StartDate" class="java.util.Date"/>
	<parameter name="EndDate" class="java.util.Date"/>
	<parameter name="AD_User_ID" class="java.lang.Integer"/>
	<parameter name="C_BankAccount_ID" class="java.lang.Integer"/>
	<parameter name="DocStatus" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="SourceType" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT
     c_bankstatement."documentno" AS documentno,
     c_bankstatement."statementdate" AS tanggal,
     c_bankstatementline."amount" AS jmlh,
     c_bankstatementline.statementlinedate as linedate,
     c_bankstatementline."description" AS keterangan,
     COALESCE(p.DocumentNo, cc.Name,'') AS Source,
     c_bankstatement."description" AS catatan,
     c_bankstatementline."transactiontype" AS tipe,
--(select array_to_string(array_agg(concat (value, '.', name)), ' & ') from c_elementvalue where c_elementvalue_id in --(case when (c_bankstatementline.c_payment_id is null OR c_bankstatementline.c_payment_id = 0) then (select --account_id  from fact_acct where ad_table_id = (SELECT AD_Table_ID FRom AD_Table WHERE TableName = --'C_BankStatement')  AND line_id = c_bankstatementline.c_bankstatementline_id AND case when --c_bankstatementline.transactiontype = 'APT' then (amtacctdr Is Not null AND amtacctdr <> 0)
--else (amtacctcr Is Not null AND amtacctcr <> 0) end) else (select account_id  from fact_acct where ad_table_id = --(SELECT AD_Table_ID FRom AD_Table WHERE TableName = 'C_Payment')  AND record_id = c_bankstatementline.C_payment_id --AND case when c_bankstatementline.transactiontype = 'APT' then (amtacctdr Is Not null AND amtacctdr <> 0)
--else (amtacctcr Is Not null AND amtacctcr <> 0) end) END )) AS accountname,
 '-' AS accountname,
(select sum(beginningbalance) from c_bankstatement where dateacct <= $P{StartDate}) as saldo_awal,
c_bankaccount."name" AS bank,
now() AS tglskrg,u.name as user
FROM
     "adempiere"."c_bankstatement" c_bankstatement
INNER JOIN "adempiere"."c_bankstatementline" c_bankstatementline ON c_bankstatement."c_bankstatement_id" = c_bankstatementline."c_bankstatement_id"
INNER JOIN "adempiere"."c_bankaccount" c_bankaccount ON c_bankstatement."c_bankaccount_id" = c_bankaccount."c_bankaccount_id"
left join ad_user u on u.ad_user_id = $P{AD_User_ID}
LEFT JOIN C_Charge cc ON cc.C_Charge_ID = c_bankstatementline.C_Charge_ID
LEFT JOIN C_Payment p ON p.C_Payment_ID = c_bankstatementline.C_Payment_ID
WHERE
c_bankstatementline."dateacct">=$P{StartDate} and c_bankstatementline."dateacct"<=$P{EndDate} and
c_bankstatement."c_bankaccount_id"=$P{C_BankAccount_ID}
and (Case When $P{DocStatus} <> '' Then c_bankstatement.docstatus=$P{DocStatus} else c_bankstatement.docstatus not in ('VO','RE') end) AND (CASE WHEN $P{SourceType} = 'PAY' THEN p.C_Payment_ID IS NOT NULL WHEN $P{SourceType} = 'CHR' THEN cc.C_Charge_ID IS NOT NULL ELSE 1=1 END)

order by linedate ASC]]>
	</queryString>
	<field name="documentno" class="java.lang.String"/>
	<field name="tanggal" class="java.sql.Timestamp"/>
	<field name="jmlh" class="java.math.BigDecimal"/>
	<field name="linedate" class="java.sql.Timestamp"/>
	<field name="keterangan" class="java.lang.String"/>
	<field name="source" class="java.lang.String"/>
	<field name="catatan" class="java.lang.String"/>
	<field name="tipe" class="java.lang.String"/>
	<field name="accountname" class="java.lang.String"/>
	<field name="saldo_awal" class="java.math.BigDecimal"/>
	<field name="bank" class="java.lang.String"/>
	<field name="tglskrg" class="java.sql.Timestamp"/>
	<field name="user" class="java.lang.String"/>
	<variable name="masuk/keluar" class="java.lang.String">
		<variableExpression><![CDATA[]]></variableExpression>
		<initialValueExpression><![CDATA[]]></initialValueExpression>
	</variable>
	<variable name="jmlh_1" class="java.math.BigDecimal" resetType="Page" calculation="Sum">
		<variableExpression><![CDATA[$F{jmlh}]]></variableExpression>
	</variable>
	<variable name="Debit" class="java.lang.Double">
		<variableExpression><![CDATA[$F{tipe} == "APT" & $F{jmlh} < 0 ? $F{jmlh}.negate(): $F{tipe}== "ART" & $F{jmlh} > 0 ? $F{jmlh} : 0]]></variableExpression>
	</variable>
	<variable name="Kredit" class="java.lang.Double">
		<variableExpression><![CDATA[$F{tipe} == "ART" & $F{jmlh} < 0 ? $F{jmlh}.negate(): $F{tipe}== "APT" & $F{jmlh} > 0 ? $F{jmlh} : 0]]></variableExpression>
	</variable>
	<variable name="TDebit" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$V{Debit}]]></variableExpression>
	</variable>
	<variable name="TKredit" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$V{Kredit}]]></variableExpression>
	</variable>
	<variable name="Number" class="java.lang.Integer">
		<variableExpression><![CDATA[$V{Number} == null ? 1 : $V{Number}+1]]></variableExpression>
	</variable>
	<group name="1">
		<groupExpression><![CDATA[$F{documentno}]]></groupExpression>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="52" splitType="Stretch">
			<textField>
				<reportElement uuid="673013fd-e077-4372-ae6f-f4deb1bb9efc" x="0" y="15" width="573" height="15"/>
				<textElement textAlignment="Center" verticalAlignment="Top"/>
				<textFieldExpression><![CDATA[$F{bank}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="8f88b6fb-78e6-41b5-954f-3900f221bd65" x="473" y="0" width="100" height="15"/>
				<textElement textAlignment="Right">
					<font size="8" isItalic="true"/>
				</textElement>
				<text><![CDATA[UntaCore Idempiere]]></text>
			</staticText>
			<textField>
				<reportElement uuid="cb538391-87e6-48a6-abec-b8a954d0524b" x="1" y="0" width="571" height="15"/>
				<textElement textAlignment="Center">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA['BUKTI BANK / KAS ']]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="019be73f-d044-4f3b-936f-e3697558e97b" x="0" y="30" width="572" height="13"/>
				<textElement textAlignment="Center">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA['Periode Tanggal '+
new SimpleDateFormat("dd/MM/yyyy").format($P{StartDate})+' s/d '+
new SimpleDateFormat("dd/MM/yyyy").format($P{EndDate})]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="f139f6c2-29c4-4f80-9851-ce3a9988d67f" x="444" y="32" width="80" height="20"/>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA["Page "+$V{PAGE_NUMBER}+" of"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement uuid="9dd339fe-3486-4426-98d5-714d213b75aa" x="524" y="32" width="40" height="20"/>
				<textElement/>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<pageHeader>
		<band height="42" splitType="Stretch">
			<rectangle>
				<reportElement uuid="d8deee8d-eec1-4b10-a88a-082d5ae5f9b4" x="0" y="1" width="572" height="18"/>
				<graphicElement>
					<pen lineColor="#999999"/>
				</graphicElement>
			</rectangle>
			<staticText>
				<reportElement uuid="bf5a1ebb-a799-462d-8565-25adb71af3fa" x="119" y="2" width="104" height="18"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<text><![CDATA[Sumber]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="22fd88f5-060d-46da-9ae2-21ebbbcc3a97" x="501" y="1" width="71" height="18"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<text><![CDATA[KREDIT]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="6586bbfd-79d2-4acd-9a28-b9636ae0962c" x="223" y="1" width="203" height="19"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<text><![CDATA[KETERANGAN]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="cdc03055-cf9b-4050-b0e4-a6958fe86736" x="426" y="0" width="75" height="19"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<text><![CDATA[DEBIT]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="7d2a42e8-cea3-4814-b4ff-12d4a76b904f" x="1" y="2" width="25" height="18"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<text><![CDATA[NO]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="ae6cb075-e31b-4697-9916-fb112604c886" x="23" y="2" width="54" height="17"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="9"/>
				</textElement>
				<text><![CDATA[Tanggal]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="bf5a1ebb-a799-462d-8565-25adb71af3fa" x="77" y="2" width="42" height="18"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<text><![CDATA[Dokumen]]></text>
			</staticText>
		</band>
	</pageHeader>
	<detail>
		<band height="14" splitType="Stretch">
			<textField>
				<reportElement uuid="68b1b19f-8cff-43c7-95ab-0aef26a81c0d" x="223" y="0" width="203" height="14"/>
				<box leftPadding="3" rightPadding="3"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{keterangan} == null ? " " : $F{keterangan}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement uuid="24fa1c38-aa8f-4237-bda0-119e9ec3e8c5" x="123" y="0" width="100" height="14"/>
				<box leftPadding="3" rightPadding="3"/>
				<textElement>
					<font fontName="Tahoma" size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{source}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="de2a9aa5-c411-411e-b19b-42fad8ab2b5b" x="426" y="0" width="75" height="14"/>
				<box leftPadding="3" rightPadding="3"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{Debit}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="0da57380-5e3e-477d-a829-885c8d57d60c" x="501" y="0" width="71" height="14"/>
				<box leftPadding="3" rightPadding="3"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{Kredit}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement uuid="dc885190-5a8c-4586-834a-7b81ac8dc3d0" x="23" y="0" width="58" height="14"/>
				<box leftPadding="3" rightPadding="3"/>
				<textElement>
					<font size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{linedate}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="c3828fd7-41b9-4741-ae7e-fd897aa4e313" x="1" y="0" width="21" height="14"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{Number}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement uuid="24fa1c38-aa8f-4237-bda0-119e9ec3e8c5" x="77" y="0" width="46" height="14"/>
				<box leftPadding="3" rightPadding="3"/>
				<textElement>
					<font fontName="Tahoma" size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{documentno}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="8"/>
	</pageFooter>
	<lastPageFooter>
		<band height="71">
			<staticText>
				<reportElement uuid="403f845c-8fdc-41b8-a402-1bcbb0a57e6d" x="430" y="36" width="71" height="20"/>
				<textElement/>
				<text><![CDATA[Tanggal Print]]></text>
			</staticText>
			<textField>
				<reportElement uuid="8f632036-cda6-4432-971d-d5877c333f61" x="501" y="36" width="71" height="20"/>
				<textElement/>
				<textFieldExpression><![CDATA[": " +new SimpleDateFormat("dd/MM/yyyy").format($F{tglskrg})]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="d2221b54-97f7-41a5-8624-769630ed30a4" x="52" y="36" width="100" height="20"/>
				<textElement/>
				<textFieldExpression><![CDATA[": " +$F{user}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="403f792d-4f25-44f4-be0d-1462990966c9" x="0" y="36" width="52" height="20"/>
				<textElement/>
				<text><![CDATA[User Print]]></text>
			</staticText>
			<line>
				<reportElement uuid="aaab10a9-5ec2-4a6d-9f24-b76a8c69fab9" x="1" y="0" width="571" height="1"/>
				<graphicElement>
					<pen lineStyle="Dashed"/>
				</graphicElement>
			</line>
			<line>
				<reportElement uuid="7d67aee8-2a29-4488-b348-f02a45156538" x="2" y="19" width="571" height="1"/>
				<graphicElement>
					<pen lineStyle="Dashed"/>
				</graphicElement>
			</line>
			<staticText>
				<reportElement uuid="2125578c-eff9-4135-97a0-a860796836f0" x="147" y="1" width="218" height="14"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<text><![CDATA[Grand Total]]></text>
			</staticText>
			<textField pattern="#,##0.00">
				<reportElement uuid="cb2a2955-21b7-4530-b0dd-e1f82a73ff33" x="385" y="1" width="88" height="14"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{TDebit}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="4316ce31-1497-47e4-9f1a-efd0e60625fe" x="473" y="1" width="98" height="14"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{TKredit}]]></textFieldExpression>
			</textField>
		</band>
	</lastPageFooter>
</jasperReport>

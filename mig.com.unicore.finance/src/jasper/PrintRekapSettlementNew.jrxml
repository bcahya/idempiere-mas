<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="PrintRekapSettlementNew" language="groovy" pageWidth="595" pageHeight="842" columnWidth="565" leftMargin="10" rightMargin="20" topMargin="10" bottomMargin="5" uuid="a83a49e2-57be-4438-a424-2925fd592975">
	<property name="ireport.zoom" value="1.8627639691774651"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="StartDate" class="java.util.Date"/>
	<parameter name="EndDate" class="java.util.Date"/>
	<parameter name="C_BPartner_ID" class="java.lang.Integer"/>
	<parameter name="AD_Org_ID" class="java.lang.Integer"/>
	<parameter name="C_BankAccount_ID" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="C_Charge_ID" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT org.Name AS Org, bsl.StatementLineDate AS TglTrx, bp.Name AS NMBPartner, c.Name AS nm_Charge, SUM(bsl.StmtAmt) * -1 AS RPCharge,cc.documentno
FROM C_BankStatementLine bsl

INNER JOIN C_BankStatement bs ON bs.C_BankStatement_ID = bsl.C_BankStatement_ID
INNER JOIN UNS_Charge_Detail cd ON cd.C_BankStatementLine_ID = bsl.C_BankStatementLine_ID
INNER JOIN UNS_Charge_Confirmation cc ON cc.UNS_Charge_Confirmation_ID = cd.UNS_Charge_Confirmation_ID
INNER JOIN AD_Org org ON org.AD_Org_ID = cc.AD_Org_ID
INNER JOIN C_BPartner bp ON bp.C_BPartner_ID = cc.C_BPartner_ID
INNER JOIN C_Charge c ON c.C_Charge_ID = cd.C_Charge_ID

WHERE bsl.StmtAmt <> 0 AND cc.DocStatus IN ('CO', 'CL') and bsl.StatementLineDate >= $P{StartDate} and bsl.StatementLineDate <= $P{EndDate} AND CASE WHEN $P{C_BPartner_ID} IS NOT NULL THEN bp.C_BPartner_ID = $P{C_BPartner_ID} ELSE 1=1 END AND CASE WHEN $P{AD_Org_ID} IS NOT NULL THEN cc.AD_Org_ID=$P{AD_Org_ID} ELSE 1=1 END
AND CASE WHEN $P{C_BankAccount_ID} IS NOT NULL THEN bs.C_BankAccount_ID = $P{C_BankAccount_ID} ELSE 1=1 END AND CASE WHEN $P{C_Charge_ID} IS NOT NULL THEN c.C_Charge_ID = $P{C_Charge_ID} ELSE 1=1 END

GROUP BY org.AD_Org_ID, bsl.StatementLineDate, bp.Name, c.C_Charge_ID,cc.documentno
ORDER BY org.Name, bp.Name, bsl.StatementLineDate, c.Name]]>
	</queryString>
	<field name="org" class="java.lang.String"/>
	<field name="tgltrx" class="java.sql.Timestamp"/>
	<field name="nmbpartner" class="java.lang.String"/>
	<field name="nm_charge" class="java.lang.String"/>
	<field name="rpcharge" class="java.math.BigDecimal"/>
	<field name="documentno" class="java.lang.String"/>
	<variable name="no" class="java.lang.Integer" incrementType="Group" incrementGroup="mmsalesman" calculation="Count">
		<variableExpression><![CDATA[new Integer("0")]]></variableExpression>
		<initialValueExpression><![CDATA[new Integer("0")]]></initialValueExpression>
	</variable>
	<variable name="ttsales" class="java.math.BigDecimal" resetType="Group" resetGroup="mmsalesman" calculation="Sum">
		<variableExpression><![CDATA[$F{rpcharge}]]></variableExpression>
	</variable>
	<variable name="ttlAll" class="java.math.BigDecimal" resetType="Group" resetGroup="org" calculation="Sum">
		<variableExpression><![CDATA[$F{rpcharge}]]></variableExpression>
	</variable>
	<variable name="variable1" class="java.math.BigDecimal" incrementType="Report" calculation="Sum"/>
	<variable name="ttReport" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{rpcharge}]]></variableExpression>
	</variable>
	<variable name="detailno" class="java.lang.Integer" resetType="Group" resetGroup="mmsalesman" calculation="Count">
		<variableExpression><![CDATA[$V{detailno} == null ? 1 : $V{detailno} + 1]]></variableExpression>
	</variable>
	<group name="org">
		<groupExpression><![CDATA[$F{org}]]></groupExpression>
		<groupHeader>
			<band height="13">
				<textField>
					<reportElement uuid="396dc735-f13c-4a7e-9ac1-115a32193203" x="0" y="0" width="207" height="13"/>
					<textElement>
						<font size="10" isUnderline="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{org}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="13">
				<textField pattern="#,##0.00">
					<reportElement uuid="f9502b46-c41c-4b1b-b830-437465c449ab" x="482" y="0" width="83" height="12"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{ttlAll}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement uuid="a35c829e-74c0-4b91-956d-6f93bd92420c" x="285" y="0" width="197" height="12"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Grand Total]]></text>
				</staticText>
			</band>
		</groupFooter>
	</group>
	<group name="mmsalesman">
		<groupExpression><![CDATA[$F{nmbpartner}]]></groupExpression>
		<groupHeader>
			<band height="11">
				<textField>
					<reportElement uuid="f13d2eb7-17f1-44f9-843c-0d470bb6e5a3" x="27" y="0" width="102" height="11"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{nmbpartner}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement uuid="b561b560-fe8e-4da1-bde8-1063d8fa8272" x="0" y="0" width="27" height="11"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{no}+1]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="11">
				<textField>
					<reportElement uuid="177b852c-3dcc-441d-b534-21473c87216d" x="285" y="0" width="197" height="11"/>
					<textElement textAlignment="Right">
						<font size="8"/>
					</textElement>
					<textFieldExpression><![CDATA['Jumlah :'+$F{nmbpartner}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.00">
					<reportElement uuid="cdf8b5ec-e7c1-4e15-b3c2-b49f718aced5" x="482" y="0" width="83" height="11"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{ttsales}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<columnHeader>
		<band height="53" splitType="Stretch">
			<rectangle>
				<reportElement uuid="273d50fa-d616-4371-b7df-d7c99bd969db" x="1" y="38" width="564" height="15"/>
				<graphicElement>
					<pen lineStyle="Dashed"/>
				</graphicElement>
			</rectangle>
			<staticText>
				<reportElement uuid="799f1a8e-0995-40b8-9776-8cb69b9d1d77" x="0" y="0" width="565" height="15"/>
				<textElement textAlignment="Center">
					<font size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[Rekap Settlement]]></text>
			</staticText>
			<textField>
				<reportElement uuid="aec4abf8-b361-4e5b-aa59-6c7a41c64ef9" x="0" y="15" width="565" height="12"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA['Periode Tanggal '+new SimpleDateFormat("dd/MM/yyyy").format($P{StartDate})+' sampai '+
new SimpleDateFormat("dd/MM/yyyy").format($P{EndDate})]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="1aa680e5-8114-45d8-aa1d-d53594b30de3" x="4" y="40" width="23" height="11"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[NO]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="a5aef1b1-ce18-4eb0-96f6-b40d8ace499f" x="27" y="40" width="102" height="11"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[Nama Salesman / Supir]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="bae40c83-ef80-4d05-ac83-6582c664975c" x="129" y="40" width="94" height="11"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[Keterangan Settlement]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="f915189f-34b4-47fb-870a-711fb2830321" x="285" y="40" width="197" height="11"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[Uraian Settlement]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="0d695f68-e17c-4a38-9ff8-aca1c8046a6b" x="482" y="40" width="83" height="11"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<text><![CDATA[Jumlah]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="672fc197-53f5-40ad-b25a-5db3ce5b493d" x="223" y="40" width="62" height="11"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[Tanggal]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="11" splitType="Stretch">
			<textField>
				<reportElement uuid="57f5e04f-ad9b-44d5-8d05-47689e512f4e" x="204" y="0" width="278" height="11"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nm_charge}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="77fddb40-cdba-41f9-b54d-2f6ac23539e6" x="482" y="0" width="83" height="11"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{rpcharge}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement uuid="a3d0c473-924c-462f-9e18-edffb4232fdb" x="129" y="0" width="75" height="11"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{tgltrx}]]></textFieldExpression>
			</textField>
			<textField pattern="">
				<reportElement uuid="a3d0c473-924c-462f-9e18-edffb4232fdb" x="84" y="0" width="45" height="11"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{no} + "." + $V{detailno}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="1b984f3e-3953-495a-bafa-d36a9eef7991" x="27" y="0" width="57" height="11"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{documentno}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<summary>
		<band height="12">
			<textField pattern="#,##0.00">
				<reportElement uuid="3f1e9752-e535-496b-9edc-d6e501e886de" x="482" y="0" width="83" height="11"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{ttReport}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="a35c829e-74c0-4b91-956d-6f93bd92420c" x="285" y="0" width="197" height="12"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Summary]]></text>
			</staticText>
		</band>
	</summary>
</jasperReport>

<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ListOfUnselectedInvoiceOnAudit" language="groovy" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="ac08bbe5-e280-4d4e-9a1f-7133be99814f">
	<property name="ireport.zoom" value="1.1000000000000005"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="UNS_Audit_ID" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="C_BPartner_ID" class="java.lang.Integer"/>
	<parameter name="isExcludeSelected" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT au.DocumentNo AS Audit, org.Value AS Org, bp.Value AS CustomerKey, bp.Name AS CustomerName, us.Name AS Sales, iv.DateInvoiced AS DateInvoiced, iv.DocumentNo AS Invoice, iv.GrandTotal AS GrandTotal, InvoiceOpenToDate(iv.C_Invoice_ID, 0, au.DateAcct) AS OpenAmt

FROM UNS_Audit au

INNER JOIN UNS_AuditPartner ap ON ap.UNS_Audit_ID = au.UNS_Audit_ID
INNER JOIN C_BPartner bp ON bp.C_BPartner_ID = ap.C_BPartner_ID
INNER JOIN UNS_AuditDocument ad ON ad.UNS_AuditPartner_ID = ap.UNS_AuditPartner_ID
INNER JOIN C_Invoice iv ON iv.C_Invoice_ID <> ad.C_Invoice_ID AND iv.C_BPartner_ID = bp.C_BPartner_ID
INNER JOIN AD_Org org ON org.AD_Org_ID = iv.AD_Org_ID
INNER JOIN AD_User us ON us.AD_User_ID = iv.SalesRep_ID
INNER JOIN C_DocType dt ON dt.C_DocType_ID = iv.C_DocType_ID

WHERE au.UNS_Audit_ID = $P{UNS_Audit_ID} AND iv.IsSOTrx = au.IsSOTrx AND iv.DocStatus IN ('CO', 'CL') AND iv.DateInvoiced <= au.DateAcct AND iv.IsPaid = 'N' AND dt.DocBaseType IN ('ARI', 'API', 'APC') AND (CASE WHEN $P{C_BPartner_ID} IS NOT NULL AND $P{isExcludeSelected} = 'N' THEN iv.C_BPartner_ID = $P{C_BPartner_ID} WHEN $P{C_BPartner_ID} IS NOT NULL AND $P{isExcludeSelected} = 'Y' THEN iv.C_BPartner_ID <> $P{C_BPartner_ID} ELSE 1=1 END)

ORDER BY CustomerName, Sales, DateInvoiced]]>
	</queryString>
	<field name="audit" class="java.lang.String"/>
	<field name="org" class="java.lang.String"/>
	<field name="customerkey" class="java.lang.String"/>
	<field name="customername" class="java.lang.String"/>
	<field name="sales" class="java.lang.String"/>
	<field name="dateinvoiced" class="java.sql.Timestamp"/>
	<field name="invoice" class="java.lang.String"/>
	<field name="grandtotal" class="java.math.BigDecimal"/>
	<field name="openamt" class="java.math.BigDecimal"/>
	<variable name="number" class="java.lang.Integer" calculation="Count">
		<variableExpression><![CDATA[$V{number} == null ? 1 : $V{number} + 1]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="20" splitType="Stretch">
			<textField>
				<reportElement uuid="3ada1138-6a40-4058-a578-d0f4f7b2011c" x="0" y="0" width="555" height="20"/>
				<textElement textAlignment="Center" markup="none">
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["List Of Unselected Invoice On Audit " + $F{audit}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="04557819-6510-43af-88b7-87dd64fd7a28" x="455" y="0" width="100" height="20"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="true" isItalic="true"/>
				</textElement>
				<text><![CDATA[UntaERP System]]></text>
			</staticText>
		</band>
	</title>
	<columnHeader>
		<band height="20" splitType="Stretch">
			<staticText>
				<reportElement uuid="17eeb8a4-7de9-4e38-96ec-37a7f836a1bd" x="65" y="0" width="51" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<text><![CDATA[Key]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="0e75e710-9dd2-4f59-9cc5-525a98b5edf8" x="116" y="0" width="109" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<text><![CDATA[Name]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="43dd6a14-a1c2-401a-871c-a2c715f76782" x="225" y="0" width="69" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<text><![CDATA[Sales]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="a8514b03-7ebb-4c35-a30b-93aaae95a04e" x="294" y="0" width="58" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<text><![CDATA[Date]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="7b1a68dd-7d16-4970-8c08-779bba07e39a" x="352" y="0" width="66" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<text><![CDATA[Invoice]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="594f8293-149a-4356-bbaa-ca6201edcaca" x="418" y="0" width="66" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<text><![CDATA[Total]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="49f9db1e-1311-4db9-bf46-82fe30b1336d" x="484" y="0" width="71" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<text><![CDATA[Open Amount]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="17eeb8a4-7de9-4e38-96ec-37a7f836a1bd" x="0" y="0" width="22" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<text><![CDATA[No.]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="17eeb8a4-7de9-4e38-96ec-37a7f836a1bd" x="22" y="0" width="43" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<text><![CDATA[Org]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="20" splitType="Stretch">
			<textField>
				<reportElement uuid="c4dcaf4f-0009-4bbe-8991-158f4a559c5d" x="65" y="0" width="51" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{customerkey}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="49f0d3b9-6618-48f7-82d1-f2658a3c246a" x="116" y="0" width="109" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{customername}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="f16b4027-5a43-49e1-8052-7fd157e31290" x="225" y="0" width="69" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{sales}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement uuid="b0798127-32f7-49db-a617-5197d9726d81" x="294" y="0" width="58" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{dateinvoiced}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="338ca96d-a98c-4ed1-84f8-7458b46e1cef" x="352" y="0" width="66" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{invoice}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="1eb5526c-6bd6-41a2-bb7f-147f990121e7" x="418" y="0" width="66" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{grandtotal}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="126ca663-6678-43e1-9cfd-d684321fa04d" x="484" y="0" width="71" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{openamt}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="c4dcaf4f-0009-4bbe-8991-158f4a559c5d" x="0" y="0" width="22" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{number}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="c4dcaf4f-0009-4bbe-8991-158f4a559c5d" x="22" y="0" width="43" height="20"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{org}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>

<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="SalesReportBasedOnSupplier_Subreport1" language="groovy" pageWidth="802" pageHeight="555" orientation="Landscape" columnWidth="802" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="94006966-f21f-4402-b1e1-2d636ed7f308">
	<property name="ireport.zoom" value="1.2100000000000006"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<style name="Crosstab Data Text" hAlign="Center"/>
	<parameter name="AD_User_ID" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="DateFrom" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="DateTo" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT Master.Partner, SUM(Master.Sale) AS Sale, SUM(Master.Retur) AS Retur, Master.now, Master.User,
sum(master.sdus) As sdus,sum(master.spack) As spack,sum(master.spcs) As spcs,
sum(master.rdus) As rdus,sum(master.rpack) As rpack,sum(master.rpcs) As rpcs
 FROM (SELECT bp.Name AS Partner, SUM(il.LineNetAmt) AS Sale, 0 AS Retur, uom.UOMSymbol AS UOM, now() AS now, us.Name AS User,
satuandus(p.m_product_id,sum(il.qtyinvoiced)) sdus,
satuanpack(p.m_product_id,sum(il.qtyinvoiced)) spack,
satuanpcs(p.m_product_id,sum(il.qtyinvoiced)) spcs,0 As rdus,0 As rpack,0 As rpcs
FROM C_Invoice iv
INNER JOIN C_InvoiceLine il ON il.C_Invoice_ID = iv.C_Invoice_ID
INNER JOIN M_Product p ON p.M_Product_ID = il.M_Product_ID
INNER JOIN C_UOM uom ON uom.C_UOM_ID = p.C_UOM_ID
INNER JOIN C_BPartner_Product bpp ON bpp.M_Product_ID = p.M_Product_ID AND bpp.IsActive = 'Y'
INNER JOIN C_BPartner bp ON bp.C_BPartner_ID = bpp.C_BPartner_ID
INNER JOIN C_DocType dt ON dt.C_DocType_ID = iv.C_DocType_ID
INNER JOIN AD_User us ON us.AD_User_ID = $P{AD_User_ID}
WHERE iv.DocStatus IN ('CO', 'CL') AND iv.IsSOTrx = 'Y' AND iv.DateInvoiced BETWEEN $P{DateFrom} AND $P{DateTo} AND dt.DocBaseType = 'ARI' AND p.IsSold = 'Y' AND p.IsPurchased = 'Y'
GROUP BY bp.C_BPartner_ID, p.M_Product_ID, uom.C_UOM_ID, us.AD_User_ID
UNION ALL
SELECT bp.Name AS Partner, 0 AS Sale, SUM(il.LineNetAmt) AS Retur, uom.UOMSymbol AS UOM, now() AS now, us.Name AS User,
0 As sdus,0 As spack,0 As spcs,
satuandus(p.m_product_id,sum(il.qtyinvoiced)) As rdus,
satuanpack(p.m_product_id,sum(il.qtyinvoiced)) As rpack,
satuanpcs(p.m_product_id,sum(il.qtyinvoiced)) As rpcs
FROM C_Invoice iv
INNER JOIN C_InvoiceLine il ON il.C_Invoice_ID = iv.C_Invoice_ID
INNER JOIN M_Product p ON p.M_Product_ID = il.M_Product_ID
INNER JOIN C_UOM uom ON uom.C_UOM_ID = p.C_UOM_ID
INNER JOIN C_BPartner_Product bpp ON bpp.M_Product_ID = p.M_Product_ID AND bpp.IsActive = 'Y'
INNER JOIN C_BPartner bp ON bp.C_BPartner_ID = bpp.C_BPartner_ID
INNER JOIN C_DocType dt ON dt.C_DocType_ID = iv.C_DocType_ID
INNER JOIN AD_User us ON us.AD_User_ID = $P{AD_User_ID}
WHERE iv.DocStatus IN ('CO', 'CL') AND iv.IsSOTrx = 'Y' AND iv.DateInvoiced BETWEEN $P{DateFrom} AND $P{DateTo} AND dt.DocBaseType = 'ARC' AND p.IsSold = 'Y' AND p.IsPurchased = 'Y'
GROUP BY bp.C_BPartner_ID, p.M_Product_ID, uom.C_UOM_ID, us.AD_User_ID) AS Master
GROUP BY Master.Partner, Master.now, Master.User
ORDER BY TRIM(Master.Partner)]]>
	</queryString>
	<field name="partner" class="java.lang.String"/>
	<field name="sale" class="java.math.BigDecimal"/>
	<field name="retur" class="java.math.BigDecimal"/>
	<field name="now" class="java.sql.Timestamp"/>
	<field name="user" class="java.lang.String"/>
	<field name="sdus" class="java.math.BigDecimal"/>
	<field name="spack" class="java.math.BigDecimal"/>
	<field name="spcs" class="java.math.BigDecimal"/>
	<field name="rdus" class="java.math.BigDecimal"/>
	<field name="rpack" class="java.math.BigDecimal"/>
	<field name="rpcs" class="java.math.BigDecimal"/>
	<variable name="nettoamount" class="java.math.BigDecimal" resetType="Column">
		<variableExpression><![CDATA[$F{sale}.subtract($F{retur})]]></variableExpression>
	</variable>
	<variable name="no" class="java.lang.Integer" calculation="Count">
		<variableExpression><![CDATA[$V{no} == null ? 1 : $V{no} + 1]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="20">
			<staticText>
				<reportElement uuid="dee66dd3-1da6-4af6-8a31-fc9e17175f6f" x="35" y="0" width="186" height="20"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Supplier]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="273ad572-3ac4-431e-861a-5e62515ba465" x="380" y="0" width="83" height="20"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Sale Amount]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="6aa1bfb0-19bd-4440-91db-f67311cb4375" x="620" y="0" width="92" height="20"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Return Amount]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="55cc17a3-dc25-48dc-95b7-b8cdca150a09" x="712" y="0" width="90" height="20"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Netto Amount]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="dee66dd3-1da6-4af6-8a31-fc9e17175f6f" x="0" y="0" width="35" height="20"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[No]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="273ad572-3ac4-431e-861a-5e62515ba465" x="221" y="0" width="51" height="20"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Sale Q.Dus]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="273ad572-3ac4-431e-861a-5e62515ba465" x="272" y="0" width="56" height="20"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Sale Q/Pack]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="273ad572-3ac4-431e-861a-5e62515ba465" x="328" y="0" width="52" height="20"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Sale Q/Pcs]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="273ad572-3ac4-431e-861a-5e62515ba465" x="570" y="0" width="50" height="20"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Ret Q/Pcs]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="273ad572-3ac4-431e-861a-5e62515ba465" x="463" y="0" width="51" height="20"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Ret Q.Dus]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="273ad572-3ac4-431e-861a-5e62515ba465" x="514" y="0" width="56" height="20"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Ret Q/Pack]]></text>
			</staticText>
		</band>
	</title>
	<detail>
		<band height="20" splitType="Stretch">
			<textField>
				<reportElement uuid="b4dd5990-c97f-44ca-9e8e-ba41be3c0196" x="35" y="0" width="186" height="20"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{partner}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="11337d17-e1bf-47d5-9cfb-9f5c7075d9fa" x="380" y="0" width="83" height="20"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{sale}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="12afdcd3-d449-4b44-824f-98fddcaeba1e" x="620" y="0" width="92" height="20"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{retur}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;(#,##0.00)">
				<reportElement uuid="fc13f44a-0255-4ed6-8b1c-77c19b7da39f" x="712" y="0" width="90" height="20"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{nettoamount}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement uuid="b4dd5990-c97f-44ca-9e8e-ba41be3c0196" x="0" y="0" width="35" height="20"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{no}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="1372c1de-ae5f-43aa-9797-14146ffd8dca" x="221" y="0" width="51" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{sdus}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="71f8abe0-ab2c-4f15-b5fe-b9913a9b2847" x="272" y="0" width="56" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{spack}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="122ade0d-4fa5-4429-8586-e0102b2a3474" x="328" y="0" width="52" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{spcs}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="59d010fa-d8e1-4b75-9d33-530b7970562a" x="463" y="0" width="51" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{rdus}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="cf5ff06e-7b4e-48ef-a345-eaaf9c789994" x="514" y="0" width="56" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{rpack}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="1baa1573-dc6f-41ed-98c3-c703b1980162" x="570" y="0" width="50" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{rpcs}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
